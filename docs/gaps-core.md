# Core Gaps (Repo ‘ÊÂ Baseline HelpDesk)

| Priority | Area | Gap | Why it matters | Current evidence | Suggested direction | Dependencies | Complexity |
| --- | --- | --- | --- | --- | --- | --- | --- |
| P0 | Search/filter | Dashboard searches `description` field that does not exist, causing Prisma error when `q` used. | Breaks search UX and API call when query provided. | Code queries `description` while schema uses `descriptionMd`.—«…F:src/app/app/page.tsx‘«·L52-L66—«≈—«…F:prisma/schema.prisma‘«·L94-L120—«≈ | Update search to use `descriptionMd` (or full-text) and add validation tests. | Prisma client, dashboard page. | M |
| P0 | Org isolation | Comment API lacks organization check; agent/admin from other org could comment if ID known. | Cross-tenant data leakage/modification risk. | Ticket fetched without org comparison before authZ checks.—«…F:src/app/api/tickets/[id]/comments/route.ts‘«·L21-L39—«≈ | Enforce ticket.organizationId == session.user.organizationId before proceeding. | Auth/session context. | S |
| P1 | Pagination | Ticket list endpoints return unbounded results. | Large datasets will slow UI and risk timeouts/memory. | `findMany` without take/skip in dashboard and API GET.—«…F:src/app/app/page.tsx‘«·L52-L73—«≈—«…F:src/app/api/tickets/route.ts‘«·L27-L35—«≈ | Add limit/offset with cursor params; surface UI controls. | Depends on API contract update. | M |
| P1 | Audit visibility | Audit events written but never exposed. | Lacks traceability for changes. | Audit writes on create/update only.—«…F:src/app/api/tickets/route.ts‘«·L75-L88—«≈—«…F:src/app/api/tickets/[id]/route.ts‘«·L172-L197—«≈ | Add audit query API and UI timeline. | Requires secure org scoping. | M |
| P1 | Attachments | Models exist but no upload/download API or UI. | Users cannot add evidence to tickets. | No routes under `src/app/api` for attachments; schema defines model.—«…F:prisma/schema.prisma‘«·L134-L145—«≈—«…F:src/app/api/tickets/route.ts‘«·L1-L89—«≈ | Implement storage-backed attachment endpoints with authZ. | Storage provider, auth. | L |
| P2 | Validation | Comment form lacks length/sanitization enforcement beyond min 1 char. | Risk of oversized/abusive content and inconsistent UX. | Client requires only `required`; server min length 1, no size limit.—«…F:src/app/app/tickets/[id]/comment-form.tsx‘«·L14-L49—«≈—«…F:src/app/api/tickets/[id]/comments/route.ts‘«·L7-L30—«≈ | Add stricter length limits and sanitization. | None. | S |
| P2 | Reporting/metrics | No reporting endpoints/UI. | Missing operational insight. | No reporting code in app routes/components.—«…F:src/app/app/page.tsx‘«·L25-L218—«≈ | Define basic KPIs and endpoints later. | Depends on data completeness. | M |
